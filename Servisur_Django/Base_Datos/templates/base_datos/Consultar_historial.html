{% extends "base_datos/base.html" %}
<!-- ðŸ”§ Envolvemos todo en un contenedor flexible -->
{% load static %}
<!-- ðŸ”§ Envolvemos todo en un contenedor flexible -->
{% block title %}Historial de Reparaciones - Servisur{% endblock %}
<!-- ðŸ”§ Envolvemos todo en un contenedor flexible -->
{% block content %}
<link rel="stylesheet" href="{% static 'css/panel.css' %}" />

<!-- ðŸ”§ Envolvemos todo en un contenedor flexible -->
<div class="d-flex flex-column min-vh-100">
  <div class="container py-4">
    <h3 class="mb-3 text-secondary">ðŸ“‹ Historial de Reparaciones</h3>

    {% if messages %}
    <div class="mb-3">
      {% for message in messages %}
      <div
        class="alert {% if message.tags %}alert-{{ message.tags }}{% else %}alert-info{% endif %}"
      >
        {{ message }}
      </div>
      {% endfor %}
    </div>
    {% endif %}

    <form method="get">
      <div class="row gx-3">
        <!-- ðŸ” Buscar por RUT -->
        <div class="col-lg-4">
          <div class="card mb-3 p-3">
            <label for="rut" class="form-label">Buscar por RUT</label>
            <input
              type="text"
              name="rut"
              id="rut"
              class="form-control"
              placeholder="Ej: 12345678"
            />
          </div>
        </div>

        <!-- ðŸ” Buscar por NÂ° Orden -->
        <div class="col-lg-4">
          <div class="card mb-3 p-3">
            <label for="orden" class="form-label">Buscar por NÂ° Orden</label>
            <input
              type="text"
              name="orden"
              id="orden"
              class="form-control"
              placeholder="Ej: 0001"
            />
          </div>
        </div>

        <!-- ðŸ“… Buscar por Fecha -->
        <div class="col-lg-4">
          <div class="card mb-3 p-3">
            <label for="fecha" class="form-label">Buscar por Fecha</label>
            <input type="date" name="fecha" id="fecha" class="form-control" />
          </div>
        </div>
      </div>

      <div class="d-flex justify-content-end">
        <button type="submit" class="btn btn-primary">Buscar</button>
      </div>
    </form>

    <hr class="my-4" />

    <!-- ðŸ“Š Resultados -->
    <div class="card p-3 animate-fade-in">
      <h6 class="mb-3">Resultados</h6>
      <div class="table-responsive">
        <table class="table table-bordered table-sm">
          <thead class="table-light">
            <tr>
              <th>Nombre</th>
              <th>Apellido</th>
              <th>NÂ° Orden</th>
              <th>Fecha</th>
              <th>RUT</th>
              <th>Marca</th>
              <th>Equipo</th>
              <th>Estado</th>
            </tr>
          </thead>
          <tbody>
            {% for rep in reparaciones %}
            <tr>
              <td>{{ rep.nombre }}</td>
              <td>{{ rep.apellido }}</td>
              <td>{{ rep.numero_orden }}</td>
              <td>{{ rep.fecha_ingreso|date:"d/m/Y" }}</td>
              <td>{{ rep.rut }}</td>
              <td>{{ rep.marca }}</td>
              <td>{{ rep.equipo }}</td>
              <td>{{ rep.estado }}</td>
            </tr>
            {% empty %}
            <tr>
              <td colspan="8" class="text-muted text-center">
                No hay reparaciones registradas.
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- ðŸ“Œ Footer fijo al fondo -->
  <footer class="mt-auto text-center small text-muted">
    <hr />
    <p class="mb-1">
      Sistema Servisur &copy; {{ now|date:"Y" }} â€” Historial de Reparaciones
    </p>
    <p class="mb-0">Desarrollado por el equipo tÃ©cnico | VersiÃ³n 1.0</p>
  </footer>
</div>

<script src="{% static 'js/historial.js' %}"></script>
{% endblock %}
