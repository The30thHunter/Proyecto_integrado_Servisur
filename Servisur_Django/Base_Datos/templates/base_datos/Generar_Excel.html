{% extends "base_datos/base.html" %}
<!-- Comentario anti errores -->
{% load static %}
<!-- Comentario anti errores -->
{% block title %}Generar Excel - Servisur{% endblock %}
<!-- Comentario anti errores -->
{% block content %}
<link rel="stylesheet" href="{% static 'css/panel.css' %}" />

<div class="d-flex flex-column min-vh-100">
  <div class="container py-4">
    <h3 class="mb-3 text-secondary">ðŸ“Š Generar Excel de Reparaciones</h3>

    <form method="get" action="{% url 'generar_excel' %}">
      <!-- ðŸ—“ï¸ SecciÃ³n 1: Filtro por rango de fechas -->
      <div class="card p-3 mb-4">
        <h6 class="mb-3">Filtrar por fecha</h6>
        <div class="row gx-3 gy-2">
          <div class="col-md-6">
            <label for="fecha_inicio" class="form-label">Desde</label>
            <input
              type="date"
              id="fecha_inicio"
              name="fecha_inicio"
              class="form-control"
              required
            />
          </div>
          <div class="col-md-6">
            <label for="fecha_fin" class="form-label">Hasta</label>
            <input
              type="date"
              id="fecha_fin"
              name="fecha_fin"
              class="form-control"
              required
            />
          </div>
        </div>
      </div>

      <!-- ðŸ“¦ SecciÃ³n 2: Filtro opcional por estado -->
      <div class="card p-3 mb-4">
        <h6 class="mb-3">Filtrar por estado (opcional)</h6>
          <select name="estado" class="form-select">
            <option value="">Todos los estados</option>
            <option value="REG">Registrado</option>
            <option value="PRO">En proceso</option>
            <option value="TER">Terminado</option>
</select>
      </div>

      <!-- ðŸ”˜ BotÃ³n generar -->
      <div class="d-flex justify-content-end">
        <button type="submit" class="btn btn-success">Generar Excel</button>
      </div>
    </form>
  </div>

  <!-- ðŸ“Œ Footer institucional -->
  <footer class="mt-auto text-center small text-muted">
    <hr />
    <p class="mb-1">
      Sistema Servisur &copy; {{ now|date:"Y" }} â€” GeneraciÃ³n de Excel
    </p>
    <p class="mb-0">Desarrollado por el equipo tÃ©cnico | VersiÃ³n 1.0</p>
  </footer>
</div>

<script src="{% static 'js/generar_excel.js' %}">

<script>
document.addEventListener('DOMContentLoaded', function(){
  const form = document.querySelector('form[action$="generar_excel"]');
  if (!form) return;
  const fi = document.getElementById('fecha_inicio');
  const ff = document.getElementById('fecha_fin');

  form.addEventListener('submit', function(e){
    const vi = fi.value.trim();
    const vf = ff.value.trim();
    if (!vi || !vf) return; // el backend ya valida
    if (vi > vf) {
      e.preventDefault();
      alert('La fecha inicio no puede ser mayor que la fecha fin.');
    }
  });
});
</script>


</script>
{% endblock %}
